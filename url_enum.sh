#!/bin/bash

# Recon tool to see whois, find subdomains, see if subdomains are alive and take screenshots
# Input partial URL Ex. tesla.com

# Run: ./url_enum.sh URL

domain=$1
RED="\033[1;31m"
#Color code
RESET="\033[0m"

info_path=$domain/info
subdomain_path=$domain/subdomains
screenshot_path=$domain/screenshots

if [ ! -d "$domain" ];then
	mkdir $domain
fi

if [ ! -d "$info_path" ];then
	mkdir $info_path
fi

if [ ! -d "$subdomain_path" ];then
	mkdir $subdomain_path
fi

if [ ! -d "$screenshot_path" ];then
	mkdir $screenshot_path
fi

echo -e "${RED} [+] Checkin' who it is...${RESET}"
whois $1 > $info_path/whois.txt

echo -e "${RED} [+] Launching subfinder...${RESET}"
subfinder -d $domain > $subdomain_path/found.txt

echo -e "${RED} [+] Running assetfinder...${RESET}"
assetfinder $domain >> $subdomain_path/found.txt

#echo -e "${RED} [+] Running Amass. This could take a while...${RESET}"
#amass enum -brute -min-for-recursive 3 -d $domain >> $subdomain_path/found.txt

echo -e "${RED} [+] Checking what's alive...${RESET}"
cat $subdomain_path/found.txt | grep $domain | sort -u >> $subdomain_path/found2.txt

cat $subdomain_path/found2.txt > $subdomain_path/found.txt

rm -rf $subdomain_path/found2.txt

cat $subdomain_path/found.txt | httprobe >> $subdomain_path/alive.txt

cat $subdomain_path/alive.txt | grep -w http | sed 's/http\?:\/\///' >> $subdomain_path/stripped.txt

cat $subdomain_path/alive.txt | grep -w https | sed 's/https\?:\/\///' >> $subdomain_path/stripped.txt

cat stripped.txt | sort -u > found.txt

rm stripped.txt

echo -e "${RED} [+] Taking dem screenshotz...${RESET}"
gowitness file -f $subdomain_path/found.txt -P $screenshot_path/

# end of script
